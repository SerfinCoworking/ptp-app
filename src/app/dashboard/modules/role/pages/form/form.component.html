<mat-card class="h-100">
  <mat-card-header>
    <h5>{{isEdit ? 'Editar rol' : 'Nuevo rol'}}</h5>
  </mat-card-header>

  <mat-card-content class="m-0">

    <form [formGroup]="roleForm" id="ngForm" (keydown.enter)="$event.preventDefault()" (ngSubmit)="isEdit ? updateClickEvent() : saveClickEvent()">
      <div class="d-flex w-100">

          <div class="w-25 p-2">
            <mat-form-field appearance="fill" class="w-100 p-1">
              <mat-label>Rol</mat-label>
              <input matInput placeholder="rol" [formControl]="name" required>

              <mat-error *ngIf="name.errors?.required">
                Debe ingresar el nombre del rol
              </mat-error>
            </mat-form-field>
            <div class="text-right">
              <button mat-stroked-button (click)="addAction()" type="button">Agregar acción</button>
            </div>
          </div>
         
          <div class="d-flex w-25 p-2">
            <div formArrayName="actions" class="w-100">
              <h5 class="">Acciones</h5>

              <div *ngFor="let action of actionForms.controls; let i = index" [formGroupName]="i" class="d-flex w-100 align-items-center">
                <div class="w-100 d-flex">
                  <mat-form-field appearance="fill" class="w-100 p-1">
                    <mat-label>Acción</mat-label>
                    <input matInput placeholder="Acción" formControlName="name" required>
                    <mat-error *ngIf="action.get('name').hasError('required')">
                      El campo nombre es requerido.
                    </mat-error>
                  </mat-form-field>

                </div>
                <button mat-stroked-button class="bg-danger text-white" (click)="deleteAction(i)" type="button" #tooltip="matTooltip" matTooltip="Quitar">
                  <fa-icon [icon]="faTrashAlt"></fa-icon>
                </button>
              </div>
            </div>
          </div>
    
      </div>
    </form>

  </mat-card-content>
  <div class="form-card pt-3 pb-0 d-flex align-items-center justify-content-end">
    <a mat-stroked-button class="bg-light mr-2" [routerLink]="['/dashboard/roles']" *ngIf="!isLoading" (click)="isLoading = !isLoading">Volver</a>
    <button mat-stroked-button form="ngForm" class="bg-success text-white" *ngIf="!isLoading">Guardar</button>
    <fa-icon [icon]="faSpinner" [spin]="true" size="2x" *ngIf="isLoading"></fa-icon>
  </div>
</mat-card>
